<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Chamados</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Estilos de destaque */
    @keyframes blinkHighlight {
      0% { background-color: #fce7f3; }
      50% { background-color: #f9a8d4; }
      100% { background-color: #fce7f3; }
    }
    .blink {
      animation: blinkHighlight 1s ease-in-out 3;
    }
    .highlight {
      background-color: #bbf7d0 !important;
      transition: background-color 1s ease;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-6">

  <div class="max-w-6xl mx-auto">
    <h1 class="text-2xl font-bold mb-6">ðŸ“Œ Sistema de Chamados</h1>

    <!-- FormulÃ¡rio de abertura -->
    <div class="bg-white p-6 rounded-2xl shadow mb-6">
      <h2 class="text-xl font-semibold mb-4">Abrir Chamado</h2>
      <form id="ticketForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input id="subject" type="text" placeholder="Assunto" class="border rounded-lg p-2" required>
        <input id="client" type="text" placeholder="Cliente" class="border rounded-lg p-2" required>
        <input id="tech" type="text" placeholder="TÃ©cnico ResponsÃ¡vel" class="border rounded-lg p-2" required>
        <select id="priority" class="border rounded-lg p-2" required>
          <option value="">Selecione a Prioridade</option>
          <option value="low">Baixa</option>
          <option value="medium">MÃ©dia</option>
          <option value="high">Alta</option>
          <option value="critical">CrÃ­tica</option>
        </select>
        <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 col-span-1 md:col-span-2">
          Abrir Chamado
        </button>
      </form>
    </div>

    <!-- Tabela de chamados -->
    <div class="bg-white p-6 rounded-2xl shadow">
      <h2 class="text-xl font-semibold mb-4">Chamados Abertos</h2>
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-gray-200">
            <th class="px-4 py-2">ID</th>
            <th class="px-4 py-2">Assunto</th>
            <th class="px-4 py-2">Cliente</th>
            <th class="px-4 py-2">TÃ©cnico</th>
            <th class="px-4 py-2">Prioridade</th>
            <th class="px-4 py-2">Status</th>
            <th class="px-4 py-2">Data</th>
            <th class="px-4 py-2">AÃ§Ãµes</th>
          </tr>
        </thead>
        <tbody id="ticketsList"></tbody>
      </table>
    </div>
  </div>

  <!-- Modal de ediÃ§Ã£o -->
  <div id="editModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white rounded-2xl p-6 w-96">
      <h2 class="text-xl font-semibold mb-4">Editar Chamado</h2>
      <form id="editForm" class="space-y-3">
        <input id="editSubject" type="text" class="border rounded-lg p-2 w-full">
        <input id="editClient" type="text" class="border rounded-lg p-2 w-full">
        <input id="editTech" type="text" class="border rounded-lg p-2 w-full">
        <select id="editPriority" class="border rounded-lg p-2 w-full">
          <option value="low">Baixa</option>
          <option value="medium">MÃ©dia</option>
          <option value="high">Alta</option>
          <option value="critical">CrÃ­tica</option>
        </select>
        <div class="flex justify-end space-x-2">
          <button type="button" onclick="closeEditModal()" class="px-4 py-2 rounded-lg border">Cancelar</button>
          <button type="submit" class="px-4 py-2 rounded-lg bg-blue-600 text-white">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal de encerramento -->
  <div id="closeModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-pink-100 border border-pink-300 rounded-2xl p-6 w-96">
      <h2 class="text-xl font-semibold mb-4 text-pink-700">Encerrar Chamado</h2>
      <p class="mb-4 text-pink-800">Tem certeza que deseja encerrar este chamado?</p>
      <div class="flex justify-end space-x-2">
        <button onclick="closeCloseModal()" class="px-4 py-2 rounded-lg border">Cancelar</button>
        <button onclick="confirmCloseTicket()" class="px-4 py-2 rounded-lg bg-pink-600 text-white">Encerrar</button>
      </div>
    </div>
  </div>

  <script>
    let tickets = [];
    let editTicketId = null;
    let closeTicketId = null;

    // Abrir chamado
    document.getElementById("ticketForm").addEventListener("submit", function(e){
      e.preventDefault();
      const newTicket = {
        id: tickets.length + 1,
        subject: document.getElementById("subject").value,
        client: document.getElementById("client").value,
        tech: document.getElementById("tech").value,
        priority: document.getElementById("priority").value,
        status: "open",
        date: new Date().toLocaleString()
      };
      tickets.push(newTicket);
      this.reset();
      renderTickets();
    });

    // Renderizar lista
    function renderTickets(){
      const list = document.getElementById("ticketsList");
      list.innerHTML = "";
      tickets.forEach(ticket => {
        const tr = document.createElement("tr");
        tr.classList.add(`priority-${ticket.priority}`);
        tr.innerHTML = `
          <td class="px-4 py-2">${ticket.id}</td>
          <td class="px-4 py-2">${ticket.subject}</td>
          <td class="px-4 py-2">${ticket.client}</td>
          <td class="px-4 py-2">${ticket.tech}</td>
          <td class="px-4 py-2 capitalize">${ticket.priority}</td>
          <td class="px-4 py-2 capitalize">${ticket.status}</td>
          <td class="px-4 py-2">${ticket.date}</td>
          <td class="px-4 py-2 space-x-2">
            <button onclick="editTicket(${ticket.id})" class="text-blue-600 hover:underline">Editar</button>
            ${ticket.status !== "resolved" ? `<button onclick="openCloseModal(${ticket.id})" class="text-pink-600 hover:underline">Encerrar</button>` : ""}
          </td>
        `;
        list.appendChild(tr);

        if(ticket.priority === "critical" && ticket.status !== "resolved") {
          tr.classList.add("blink");
        }
      });
    }

    // Editar chamado
    function editTicket(id){
      editTicketId = id;
      const t = tickets.find(t => t.id === id);
      if(t){
        document.getElementById("editSubject").value = t.subject;
        document.getElementById("editClient").value = t.client;
        document.getElementById("editTech").value = t.tech;
        document.getElementById("editPriority").value = t.priority;
        document.getElementById("editModal").classList.remove("hidden");
      }
    }

    document.getElementById("editForm").addEventListener("submit", function(e){
      e.preventDefault();
      const t = tickets.find(t => t.id === editTicketId);
      if(t){
        t.subject = document.getElementById("editSubject").value;
        t.client = document.getElementById("editClient").value;
        t.tech = document.getElementById("editTech").value;
        t.priority = document.getElementById("editPriority").value;
        renderTickets();
        closeEditModal();
      }
    });

    function closeEditModal(){
      document.getElementById("editModal").classList.add("hidden");
    }

    // Encerrar chamado
    function openCloseModal(id){
      closeTicketId = id;
      document.getElementById("closeModal").classList.remove("hidden");
    }

    function closeCloseModal(){
      document.getElementById("closeModal").classList.add("hidden");
    }

    function confirmCloseTicket(){
      if(closeTicketId !== null){
        const t = tickets.find(t => t.id === closeTicketId);
        if(t){
          t.status = "resolved";
          renderTickets();
          closeCloseModal();
          alert(`Chamado #${t.id} encerrado com sucesso!`);
        }
      }
    }
  </script>
</body>
</html>
